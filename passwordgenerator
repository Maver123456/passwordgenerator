import random
import string

try:
    import pyperclip
    clipboard_available = True
except ImportError:
    clipboard_available = False

def get_password_length():
    while True:
        try:
            length = int(input("Enter password length (8-32): "))
            if 8 <= length <= 32:
                return length
            else:
                print("Length should be between 8 and 32.")
        except ValueError:
            print("Enter a valid number.")

def choose_characters():
    print("\nChoose character types to include in your password:")
    include_upper = input("Include uppercase letters? (y/n): ").lower() == "y"
    include_lower = input("Include lowercase letters? (y/n): ").lower() == "y"
    include_digits = input("Include digits? (y/n): ").lower() == "y"
    include_symbols = input("Include symbols? (y/n): ").lower() == "y"
    
    if not (include_upper or include_lower or include_digits or include_symbols):
        print("You must select at least one character type!")
        return choose_characters()
    
    chars = ""
    if include_upper:
        chars += string.ascii_uppercase
    if include_lower:
        chars += string.ascii_lowercase
    if include_digits:
        chars += string.digits
    if include_symbols:
        chars += string.punctuation
    return chars

def evaluate_strength(password):
    length = len(password)
    categories = sum([
        any(c.islower() for c in password),
        any(c.isupper() for c in password),
        any(c.isdigit() for c in password),
        any(c in string.punctuation for c in password)
    ])
    
    if length >= 12 and categories >= 3:
        return "Strong"
    elif length >= 10 and categories >= 2:
        return "Moderate"
    else:
        return "Weak"

def generate_password():
    print("\n--- Password Generator ---")
    length = get_password_length()
    chars = choose_characters()
    
    password = "".join(random.choice(chars) for _ in range(length))
    print(f"\nGenerated Password: {password}")
    print(f"Password Strength: {evaluate_strength(password)}")
    
    if clipboard_available:
        pyperclip.copy(password)
        print("Password copied to clipboard!")

def main():
    print("Welcome to the Enhanced Password Generator!\n")
    while True:
        generate_password()
        again = input("\nGenerate another password? (y/n): ").lower()
        if again != "y":
            print("Goodbye!")
            break

if __name__ == "__main__":
    main()

import tkinter as tk
from tkinter import messagebox
import random
import string

try:
    import pyperclip
    clipboard_available = True
except ImportError:
    clipboard_available = False

AMBIGUOUS = "O0l1I"

def evaluate_strength(password):
    length = len(password)
    categories = sum([
        any(c.islower() for c in password),
        any(c.isupper() for c in password),
        any(c.isdigit() for c in password),
        any(c in string.punctuation for c in password)
    ])
    
    if length >= 12 and categories >= 3:
        return "Strong"
    elif length >= 10 and categories >= 2:
        return "Moderate"
    else:
        return "Weak"

def generate_passwords():
    try:
        length = int(length_entry.get())
        count = int(count_entry.get())
        if length < 8 or length > 32 or count < 1:
            messagebox.showerror("Error", "Length 8-32, Count >=1")
            return
    except ValueError:
        messagebox.showerror("Error", "Enter valid numbers")
        return
    
    chars = ""
    if upper_var.get(): chars += string.ascii_uppercase
    if lower_var.get(): chars += string.ascii_lowercase
    if digits_var.get(): chars += string.digits
    if symbols_var.get(): chars += string.punctuation
    
    if exclude_var.get():
        chars = ''.join(c for c in chars if c not in AMBIGUOUS)
    
    if not chars:
        messagebox.showerror("Error", "Select at least one character type!")
        return
    
    password_list.delete(0, tk.END)
    for _ in range(count):
        password = "".join(random.choice(chars) for _ in range(length))
        password_list.insert(tk.END, f"{password}  ({evaluate_strength(password)})")
    
    if clipboard_available:
        pyperclip.copy(password_list.get(0))

def generate_strong_password():
    length_entry.delete(0, tk.END)
    length_entry.insert(0, "16")
    upper_var.set(True)
    lower_var.set(True)
    digits_var.set(True)
    symbols_var.set(True)
    exclude_var.set(True)
    count_entry.delete(0, tk.END)
    count_entry.insert(0, "1")
    generate_passwords()

# GUI Setup
root = tk.Tk()
root.title("Advanced Password Generator")
root.geometry("500x450")
root.resizable(False, False)

tk.Label(root, text="Password Length (8-32):").pack(pady=2)
length_entry = tk.Entry(root)
length_entry.pack()
length_entry.insert(0, "12")

tk.Label(root, text="Number of Passwords:").pack(pady=2)
count_entry = tk.Entry(root)
count_entry.pack()
count_entry.insert(0, "1")

upper_var = tk.BooleanVar(value=True)
lower_var = tk.BooleanVar(value=True)
digits_var = tk.BooleanVar(value=True)
symbols_var = tk.BooleanVar(value=True)
exclude_var = tk.BooleanVar(value=False)

tk.Checkbutton(root, text="Include Uppercase", variable=upper_var).pack(anchor='w')
tk.Checkbutton(root, text="Include Lowercase", variable=lower_var).pack(anchor='w')
tk.Checkbutton(root, text="Include Digits", variable=digits_var).pack(anchor='w')
tk.Checkbutton(root, text="Include Symbols", variable=symbols_var).pack(anchor='w')
tk.Checkbutton(root, text="Exclude Ambiguous Characters (O0l1I)", variable=exclude_var).pack(anchor='w')

tk.Button(root, text="Generate Password(s)", command=generate_passwords).pack(pady=5)
tk.Button(root, text="Generate Strong Password (Recommended)", command=generate_strong_password).pack(pady=5)

password_list = tk.Listbox(root, width=60)
password_list.pack(pady=5)

tk.Button(root, text="Copy Selected to Clipboard", command=lambda: pyperclip.copy(password_list.get(tk.ACTIVE)) if clipboard_available else None).pack(pady=5)

root.mainloop()

